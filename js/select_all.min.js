if("undefined"==typeof jQuery)throw new Error("select_all requires jQuery");!function(t){t.fn.select_all=function(e){function a(e){for(var a,l;!e.is("body");)l=e.find(":checkbox.selectable"),l.length>0?(a=l,e=t("body")):e=e.parent();return a}function l(e,a,l){switch(e.data("show_count")){case"selected":count_result="(Selected "+a+")";break;case"selected_with_total":count_result="("+a+"/"+l+")";break;case"unselected":var c=l-a;count_result="(Unselected "+c+")";break;default:count_result="(Selected "+a+")"}var s=t(e.data("attach_count_to"));0==s.length&&(s=e.parent()),t("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").length>0?t("span#select_all_count_id[data-select_all_uid='"+e.data("select_all_uid")+"']").text(count_result):t("<span id='select_all_count_id' data-select_all_uid="+e.data("select_all_uid")+">"+count_result+"</span>").appendTo(s)}function c(e){t(e).change(function(){var e=t(".select_all[data-select_all_class='"+_["class"]+"']"),a=t(".selectable."+_["class"]+":checked").length,c=t(".selectable."+_["class"]).length;a==c?e.prop("checked","checked"):e.prop("checked",!1),e.data("show_count").length>0&&l(e,a,c)})}function s(e){var a=t(".selectable."+_["class"]);e.change(function(){var c=t(this).prop("checked");if(a.prop("checked",c),e.data("show_count").length>0){var s=c?a.length:0;l(e,s,a.length)}})}var n,_=t.extend({"class":"no_class",infinite_scroll_select:!1,show_count:!1,attach_count_to:!1,uniq_id:Math.random()},e),o=t(this),d=o;return o.addClass("select_all").attr("data-select_all_class",_["class"]).attr("data-select_all_uid",_.uniq_id),o.data("show_count",_.show_count),o.data("attach_count_to",_.attach_count_to),n=a(d),n.length>0&&n.addClass(_["class"]),t(".select_all[data-select_all_class='"+_["class"]+"']").change(function(){t(".selectable."+_["class"]).prop("checked",t(this).prop("checked"))}),_.infinite_scroll_select&&(t(o).attr("data-total_child_count",n.length),t(document).ajaxComplete(function(e,l,s){t("[data-total_child_count]").each(function(){var e=t(this),l=a(e);l.length>e.data("total_child_count")&&(l.addClass(e.data("select_all_class")),e.attr("data-total_child_count",l.length),c(l),e.prop("checked")&&l.prop("checked",!0))})})),_.show_count!==!1&&l(o,n.parent().find(":checked").length,n.length),s(o),c(n),t(this)}}(jQuery);
